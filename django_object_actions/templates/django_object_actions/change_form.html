{% extends "admin/change_form.html" %}
{% load add_preserved_filters from admin_urls %}

{% block object-tools-items %}
  {% for tool in objectactions %}
    <li class="objectaction-item" data-tool-name="{{ tool.name }}">
      {% url tools_view_name pk=object_id tool=tool.name as action_url %}
      <form name="{{ tool.name }}__form" method="post" action="{% add_preserved_filters action_url %}">
        {% csrf_token %}
        <a href="javascript:window.document.forms['{{ tool.name }}__form'].submit()" title="{{ tool.standard_attrs.title }}"
          {% for k, v in tool.custom_attrs.items %}
            {{ k }}="{{ v }}"
          {% endfor %}
          class="{{ tool.standard_attrs.class }}">
          {{ tool.label|capfirst }}
        </a>
      </form>
    </li>
  {% endfor %}
  {{ block.super }}
{% endblock %}
